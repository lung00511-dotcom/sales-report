<!DOCTYPE html><html lang="zh-HK"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>éŠ·å”®å ±æ•¸å¹³å°</title><style>
/* ä¿ç•™åŸæœ¬ CSS */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f3f4f6; color: #1f2937; }
.navbar { background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); padding: 1.2rem 2rem; display: flex; justify-content: space-between; align-items: center; color: white; }
.navbar h1 { font-size: 1.4rem; font-weight: 700; }
.navbar-user { display: flex; gap: 1.5rem; align-items: center; font-size: 0.9rem; }
.logout-btn, .export-btn { background: rgba(255,255,255,0.25); color: white; padding: 0.6rem 1.2rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: 0.2s; }
.logout-btn:hover, .export-btn:hover { background: rgba(255,255,255,0.35); transform: translateY(-1px); }
.container { max-width: 1200px; margin: 0 auto; padding: 2rem 1.5rem; }
#login-screen { display: flex; align-items: center; justify-content: center; min-height: 100vh; background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); padding: 1rem; }
.login-box { background: white; padding: 3rem; border-radius: 12px; max-width: 420px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.2); width: 100%; }
.login-box h2 { font-size: 2.2rem; color: #3b82f6; margin-bottom: 0.5rem; }
.login-box p { color: #6b7280; margin-bottom: 2rem; }
.login-input { width: 100%; padding: 0.95rem; margin-bottom: 1rem; border: 2px solid #e5e7eb; border-radius: 8px; }
.login-btn { width: 100%; padding: 1rem; background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
#staff-screen, #admin-screen { display: none; }
table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
th { background-color: #e5e7eb; }
input[type="number"], select { width: 100%; padding: 0.3rem; }
</style></head><body><!-- LOGIN SCREEN --><div id="login-screen"><div class="login-box"><h2>ğŸ“Š éŠ·å”®å ±æ•¸å¹³å°</h2><p>Sales Reporting System v2.0</p><input type="text" id="user-name" class="login-input" placeholder="è¼¸å…¥åå­—" autocomplete="off" /><select id="user-role" class="login-input" onchange="toggleAdminPass()"><option value="">é¸æ“‡èº«ä»½</option><option value="staff">åŒäº‹ (å ±æ•¸)</option><option value="admin">ç®¡ç†å“¡ (æŸ¥çœ‹çµ±è¨ˆ)</option></select><div id="admin-pass-div" style="display: none;"><input type="password" id="admin-pass" class="login-input" placeholder="è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼" autocomplete="off" /></div><button class="login-btn" onclick="handleLogin()">ğŸ”“ ç™»å…¥</button></div></div><!-- STAFF SCREEN --><div id="staff-screen"><div class="navbar"><h1>ğŸ“‹ åŒäº‹å ±æ•¸è¡¨å–®</h1><div class="navbar-user"><span id="staff-name">åŒäº‹: -</span><span id="staff-date">æ—¥æœŸ: -</span><button class="logout-btn" onclick="logout()">ğŸšª ç™»å‡º</button></div></div><div class="container"><h2>ä»Šæ—¥å ±æ•¸</h2><form id="staff-form"><table><tr><th>é …ç›®</th><th>æ•¸é‡</th></tr><tr><td>CIS</td><td><input type="number" name="cis" min="0"></td></tr><tr><td>VAS</td><td><input type="number" name="vas" min="0"></td></tr><tr><td>Ad Hoc</td><td><input type="number" name="adhoc" min="0"></td></tr><tr><td>Gadgets</td><td><input type="number" name="gadgets" min="0"></td></tr></table><button type="submit" class="login-btn" style="margin-top:1rem;">æäº¤å ±æ•¸</button></form><p id="staff-msg" style="margin-top:1rem;color:green;"></p></div></div><!-- ADMIN SCREEN --><div id="admin-screen"><div class="navbar"><h1>ğŸ“Š ç®¡ç†å“¡çµ±è¨ˆé é¢</h1><div class="navbar-user"><span id="admin-name">ç®¡ç†å“¡: -</span><button class="export-btn" onclick="exportToExcel()">â¬‡ï¸ åŒ¯å‡º Excel</button><button class="logout-btn" onclick="logout()">ğŸšª ç™»å‡º</button></div></div><div class="container"><h2>æ‰€æœ‰å ±æ•¸è¨˜éŒ„</h2><table id="report-table"><thead><tr><th>æ—¥æœŸ</th><th>åŒäº‹</th><th>CIS</th><th>VAS</th><th>Ad Hoc</th><th>Gadgets</th></tr></thead><tbody></tbody></table></div></div><script>
let records = [];

function toggleAdminPass() {
    document.getElementById("admin-pass-div").style.display = (document.getElementById("user-role").value === "admin") ? "block" : "none";
}

function handleLogin() {
    const name = document.getElementById("user-name").value.trim();
    const role = document.getElementById("user-role").value;
    const adminPass = document.getElementById("admin-pass").value;

    if (!name) return alert("è«‹è¼¸å…¥åå­—");
    if (!role) return alert("è«‹é¸æ“‡èº«ä»½");

    if (role === "admin") {
        if (adminPass !== "1234") return alert("ç®¡ç†å“¡å¯†ç¢¼éŒ¯èª¤");
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("admin-screen").style.display = "block";
        document.getElementById("admin-name").textContent = "ç®¡ç†å“¡: " + name;
        loadReports();
    } else {
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("staff-screen").style.display = "block";
        document.getElementById("staff-name").textContent = "åŒäº‹: " + name;
        document.getElementById("staff-date").textContent = "æ—¥æœŸ: " + new Date().toLocaleDateString();
    }
}

function logout() {
    document.getElementById("staff-screen").style.display = "none";
    document.getElementById("admin-screen").style.display = "none";
    document.getElementById("login-screen").style.display = "flex";
    document.getElementById("user-name").value = "";
    document.getElementById("user-role").value = "";
    document.getElementById("admin-pass").value = "";
    document.getElementById("admin-pass-div").style.display = "none";
}

document.getElementById("staff-form").addEventListener("submit", function(e) {
    e.preventDefault();
    const formData = new FormData(e.target);
    const record = {
        date: new Date().toLocaleDateString(),
        name: document.getElementById("staff-name").textContent.replace("åŒäº‹: ", ""),
        cis: formData.get("cis") || 0,
        vas: formData.get("vas") || 0,
        adhoc: formData.get("adhoc") || 0,
        gadgets: formData.get("gadgets") || 0
    };
    records.push(record);
    document.getElementById("staff-msg").textContent = "âœ… å·²æäº¤å ±æ•¸ï¼";
    e.target.reset();
});

function loadReports() {
    const tbody = document.querySelector("#report-table tbody");
    tbody.innerHTML = "";
    records.forEach(r => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${r.date}</td><td>${r.name}</td><td>${r.cis}</td><td>${r.vas}</td><td>${r.adhoc}</td><td>${r.gadgets}</td>`;
        tbody.appendChild(tr);
    });
}

// åŒ¯å‡º Excel
function exportToExcel() {
    if (records.length === 0) {
        alert("æš«ç„¡è³‡æ–™å¯åŒ¯å‡º");
        return;
    }
    let csvContent = "data:text/csv;charset=utf-8," 
        + ["æ—¥æœŸ,åŒäº‹,CIS,VAS,Ad Hoc,Gadgets", ...records.map(r => `${r.date},${r.name},${r.cis},${r.vas},${r.adhoc},${r.gadgets}`)].join("\n");

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "sales_report.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
</script></body></html>
