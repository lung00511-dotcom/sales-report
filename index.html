<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŠ·å”®å ±æ•¸å¹³å°</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f3f4f6; color: #1f2937; }
        
        .navbar { background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); padding: 1.2rem 2rem; display: flex; justify-content: space-between; align-items: center; color: white; }
        .navbar h1 { font-size: 1.4rem; font-weight: bold; }
        .navbar-actions { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
        .logout-btn, .sync-btn { background: rgba(255,255,255,0.25); color: white; padding: 0.6rem 1.2rem; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.9rem; }
        .sync-btn { background: rgba(100,255,100,0.3); }
        .sync-btn:hover { background: rgba(100,255,100,0.5); }
        .sync-status { color: white; font-size: 0.9rem; padding: 0.5rem 1rem; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem 1.5rem; }
        
        #login-screen { display: flex; align-items: center; justify-content: center; min-height: 100vh; background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); padding: 1rem; }
        .login-box { background: white; padding: 3rem; border-radius: 12px; width: 100%; max-width: 420px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.2); }
        .login-box h2 { font-size: 2.2rem; color: #3b82f4; margin-bottom: 1rem; }
        .login-input { width: 100%; padding: 0.95rem; margin-bottom: 1rem; border: 2px solid #e5e7eb; border-radius: 8px; }
        .login-btn { width: 100%; padding: 1rem; background: linear-gradient(135deg, #3b82f4 0%, #1e40af 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        
        #staff-screen, #admin-screen { display: none; }
        
        .form-card { background: white; padding: 2.5rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
        .form-card h2 { font-size: 1.3rem; color: #3b82f4; margin-bottom: 1.5rem; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem; margin-bottom: 1.5rem; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: bold; margin-bottom: 0.5rem; }
        .form-group input, .form-group textarea, .form-group select { padding: 0.8rem; border: 1px solid #d1d5db; border-radius: 6px; }
        
        .gadgets-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1.2rem; margin-bottom: 1.5rem; }
        .gadget-card { padding: 1rem; background: white; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; text-align: center; }
        .gadget-card:hover { border-color: #3b82f4; background: #eff6ff; }
        .gadget-card.selected { background: #3b82f4; color: white; border-color: #1e40af; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); }
        .gadget-emoji { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .gadget-text { font-size: 0.75rem; line-height: 1.2; }
        .gadget-qty { font-size: 0.7rem; background: rgba(0,0,0,0.1); padding: 0.3rem 0.6rem; border-radius: 4px; margin-top: 0.5rem; }
        
        .gadget-detail { display: none; background: linear-gradient(135deg, #eff6ff 0%, #e0f2fe 100%); padding: 2rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #3b82f4; }
        .gadget-detail.active { display: block; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        .detail-header { display: flex; gap: 2rem; margin-bottom: 1.5rem; }
        .detail-emoji { font-size: 4rem; min-width: 80px; }
        .detail-info h3 { color: #3b82f4; font-size: 1.2rem; margin-bottom: 0.3rem; font-weight: bold; }
        .detail-brand { color: #ef4444; font-weight: bold; margin-bottom: 0.5rem; }
        .spec-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem; background: white; padding: 1rem; border-radius: 6px; }
        .spec-item { border-left: 3px solid #3b82f4; padding-left: 0.8rem; }
        .spec-label { font-weight: bold; color: #3b82f4; font-size: 0.9rem; }
        .spec-value { color: #374151; font-size: 0.95rem; margin-top: 0.2rem; }
        
        .pain-points { background: white; padding: 1rem; border-radius: 6px; margin-top: 1rem; }
        .pain-points h4 { color: #1e40af; margin-bottom: 0.8rem; }
        .pain-point-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 0.8rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.8rem; }
        .pain-point-row:last-child { border-bottom: none; }
        .pain-point-left { background: #fef2f2; padding: 0.8rem; border-radius: 4px; }
        .pain-point-right { background: #f0fdf4; padding: 0.8rem; border-radius: 4px; }
        .pain-title { font-weight: bold; color: #ef4444; margin-bottom: 0.3rem; font-size: 0.9rem; }
        .solution-title { font-weight: bold; color: #10b981; margin-bottom: 0.3rem; font-size: 0.9rem; }
        .pain-text, .solution-text { font-size: 0.9rem; line-height: 1.5; }
        
        .qty-input { background: white; padding: 1.2rem; border-radius: 8px; border-left: 3px solid #10b981; margin-bottom: 1rem; }
        .qty-input label { font-weight: bold; color: #10b981; margin-bottom: 0.5rem; }
        .qty-input input { padding: 0.8rem; border: 1px solid #d1d5db; border-radius: 6px; width: 100%; }
        .add-gadget-btn { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 0.8rem 1.5rem; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .add-gadget-btn:hover { opacity: 0.9; }
        
        .selected-gadgets { background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; }
        .selected-gadgets h3 { color: #3b82f4; margin-bottom: 1rem; font-size: 1.1rem; }
        .gadget-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: #f9fafb; border-radius: 6px; margin-bottom: 0.8rem; border-left: 3px solid #3b82f4; }
        .gadget-item-info { flex: 1; }
        .gadget-item-name { font-weight: bold; color: #1f2937; }
        .gadget-item-qty { color: #6b7280; font-size: 0.9rem; }
        .remove-btn { background: #ef4444; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .remove-btn:hover { opacity: 0.9; }
        
        .submit-btn { width: 100%; padding: 1.1rem; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 1.5rem; }
        .success-alert { display: none; padding: 1rem; background: #d1fae5; color: #065f46; border-radius: 8px; margin-top: 1rem; text-align: center; font-weight: bold; }
        .success-alert.show { display: block; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-box { background: white; padding: 1.5rem; border-radius: 8px; border-top: 4px solid #3b82f4; text-align: center; }
        .stat-value { font-size: 2.4rem; font-weight: bold; color: #3b82f4; }
        
        .table-card { background: white; border-radius: 8px; overflow: hidden; }
        .table-header { background: #f3f4f6; padding: 1rem 1.5rem; display: flex; justify-content: space-between; }
        .export-btns { display: flex; gap: 1rem; flex-wrap: wrap; }
        .export-btn { padding: 0.8rem 1rem; background: #3b82f4; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.9rem; }
        
        table { width: 100%; border-collapse: collapse; }
        table th { background: #f9fafb; padding: 1rem; text-align: left; font-weight: bold; border-bottom: 2px solid #e5e7eb; font-size: 0.9rem; }
        table td { padding: 0.9rem 1rem; border-bottom: 1px solid #e5e7eb; font-size: 0.9rem; }
    </style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="login-screen">
    <div class="login-box">
        <h2>ğŸ“Š éŠ·å”®å ±æ•¸å¹³å°</h2>
        <p>Gadget Installment Offer</p>
        <input type="text" id="user-name" class="login-input" placeholder="è¼¸å…¥åå­—" />
        <select id="user-role" class="login-input">
            <option value="">é¸æ“‡èº«ä»½</option>
            <option value="staff">åŒäº‹ (å ±æ•¸)</option>
            <option value="admin">ç®¡ç†å“¡ (æŸ¥çœ‹çµ±è¨ˆ)</option>
        </select>
        <div id="admin-pass-section" style="display: none;">
            <input type="password" id="admin-pass" class="login-input" placeholder="è¼¸å…¥å¯†ç¢¼" />
        </div>
        <button class="login-btn" onclick="handleLogin()">ğŸ”“ ç™»å…¥</button>
    </div>
</div>

<!-- STAFF SCREEN -->
<div id="staff-screen">
    <div class="navbar">
        <h1>ğŸ“‹ åŒäº‹å ±æ•¸è¡¨å–®</h1>
        <div class="navbar-actions">
            <div>
                <span id="staff-name">åŒäº‹: -</span> | 
                <span id="staff-date">æ—¥æœŸ: -</span>
            </div>
            <button class="logout-btn" onclick="logout()">ğŸšª ç™»å‡º</button>
        </div>
    </div>
    <div class="container">
        <div class="form-card">
            <h2>ğŸ“ å¡«å¯«ä»Šæ—¥éŠ·å”®æ•¸æ“š</h2>
            <form onsubmit="submitStaffReport(event)">
                <h3 style="margin-bottom: 1rem; color: #3b82f4;">ğŸ ç¦®å“éŠ·å”® (é»æ“ŠæŸ¥çœ‹è©³æƒ… + é¸æ“‡æ•¸é‡)</h3>
                <div class="gadgets-grid" id="gadgets-grid"></div>
                
                <div id="gadget-detail" class="gadget-detail">
                    <div class="detail-header">
                        <div class="detail-emoji" id="detail-emoji">ğŸ“¦</div>
                        <div class="detail-info" style="flex: 1;">
                            <h3 id="detail-name"></h3>
                            <div class="detail-brand" id="detail-brand"></div>
                            <p style="font-size: 0.9rem; color: #6b7280; margin-bottom: 1rem;" id="detail-brand-desc"></p>
                            <p><strong>ğŸ”§ å‹è™Ÿ:</strong> <span id="detail-model"></span></p>
                            <p><strong>ğŸ’° SRP åŸåƒ¹:</strong> <span id="detail-srp" style="color: #ef4444; font-size: 1.1rem;"></span></p>
                        </div>
                    </div>
                    
                    <div class="spec-grid" id="spec-grid"></div>
                    
                    <div class="pain-points">
                        <h4>ğŸ’¡ çœŸå¯¦é¡§å®¢ Pain Point & è§£æ±ºæ–¹æ¡ˆ</h4>
                        <div id="pain-points-content"></div>
                    </div>
                    
                    <div class="qty-input">
                        <label for="current-qty" id="qty-label">è¼¸å…¥éŠ·å”®æ•¸é‡</label>
                        <input type="number" id="current-qty" min="0" value="0" />
                        <button type="button" class="add-gadget-btn" onclick="addGadgetToList()" style="margin-top: 0.8rem; width: 100%;">â• åŠ å…¥æ¸…å–®</button>
                    </div>
                </div>
                
                <!-- å·²é¸æ“‡ç¦®å“æ¸…å–® -->
                <div id="selected-list" class="selected-gadgets" style="display: none;">
                    <h3>âœ… å·²é¸æ“‡ç¦®å“</h3>
                    <div id="gadgets-list"></div>
                </div>
                
                <h3 style="margin-top: 2rem; color: #3b82f4;">ğŸ“Š éŠ·å”®æ•¸æ“š</h3>
                <div class="form-row">
                    <div class="form-group"><label>ğŸ“± CIS è¨‚å–®æ•¸</label><input type="number" id="cis" min="0" value="0" /></div>
                    <div class="form-group"><label>â• VAS å¢å€¼æœå‹™</label><input type="number" id="vas" min="0" value="0" /></div>
                </div>
                
                <h3 style="color: #3b82f4;">ğŸ‘” åœ˜éšŠè³‡è¨Š</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Leader</label>
                        <select id="leader" required>
                            <option value="">é¸æ“‡ Leader</option>
                            <option value="Nelson Wong">Nelson Wong</option>
                            <option value="Billy Lam">Billy Lam</option>
                            <option value="Timothy Chan">Timothy Chan</option>
                        </select>
                    </div>
                </div>
                
                <h3 style="color: #3b82f4;">ğŸ“± Ad-Hoc VAS</h3>
                <div class="form-row">
                    <div class="form-group"><label>2500M</label><input type="number" id="adhoc1" min="0" value="0" /></div>
                    <div class="form-group"><label>Router</label><input type="number" id="adhoc2" min="0" value="0" /></div>
                    <div class="form-group"><label>PCD NEW</label><input type="number" id="adhoc3" min="0" value="0" /></div>
                </div>
                
                <div class="form-group">
                    <label>ğŸ“Œ å‚™è¨» (é¸å¡«)</label>
                    <textarea id="notes" style="min-height: 80px;"></textarea>
                </div>
                
                <button type="submit" class="submit-btn">âœ… æäº¤å ±æ•¸</button>
            </form>
            <div id="success-msg" class="success-alert">âœ… å ±æ•¸å·²æˆåŠŸä¿å­˜ï¼</div>
        </div>
    </div>
</div>

<!-- ADMIN SCREEN -->
<div id="admin-screen">
    <div class="navbar">
        <h1>ğŸ“Š ç®¡ç†å“¡å„€è¡¨æ¿</h1>
        <div class="navbar-actions">
            <div class="sync-status" id="sync-status"></div>
            <button class="sync-btn" onclick="syncToGoogleSheets()">â˜ï¸ åŒæ­¥åˆ° Google Sheets</button>
            <button class="export-btn" onclick="exportToCSV()">ğŸ“¥ ä¸‹è¼‰ CSV</button>
            <button class="logout-btn" onclick="logout()">ğŸšª ç™»å‡º</button>
        </div>
    </div>
    <div class="container">
        <div class="stats-grid" id="stats-grid"></div>
        
        <div class="table-card">
            <div class="table-header">
                <h3>ğŸ“ˆ éŠ·å”®çµ±è¨ˆè¡¨</h3>
            </div>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>æ—¥æœŸ</th><th>åŒäº‹</th><th>Leader</th><th>CIS</th><th>VAS</th><th>2500M</th><th>Router</th><th>PCD NEW</th><th>ç¦®å“éŠ·å”®</th><th>å‚™è¨»</th>
                        </tr>
                    </thead>
                    <tbody id="table-body"></tbody>
                </table>
            </div>
            <div id="no-data-msg" style="text-align: center; padding: 3rem; color: #999;">æš«ç„¡æ•¸æ“š</div>
        </div>
    </div>
</div>

<script>
const ADMIN_PASSWORD = "admin2024";
// âš ï¸ æ”¹æˆä½ å˜… Google Sheets API è³‡è¨Š
const GOOGLE_SHEET_ID = "1i4BQoxepAJYA_LtLcc-vsClhoVWwPmfA6coU-SNaGw8";
const GOOGLE_API_KEY = "AIzaSyAoaREbhHFto0z4RoJaylmnJi06sOEj8A4";

const GADGETS = [
    {
        id: 0,
        emoji: "ğŸ”¥",
        name: "æ›ç‡™é‡‘çƒé›»å£“æ‰‹æŒæ›ç‡™æ©Ÿ",
        brand: "inno3C",
        model: "i-GS1",
        brandDesc: "inno3C - å‰µæ–°3Cç§‘æŠ€å“ç‰Œï¼Œå°ˆæ³¨æ–¼æ™ºèƒ½ç”Ÿæ´»é›»å™¨",
        srp: "$598",
        specs: {
            "æ›ç‡™æº«åº¦": "70-85Â°C æ†æº«",
            "åŠ ç†±æ™‚é–“": "30ç§’å¿«é€Ÿé ç†±",
            "å®¹æ°´é‡": "80mlï¼ˆå¯æŒçºŒ15åˆ†é˜ï¼‰",
            "ç·šé•·": "1.5m",
            "é‡é‡": "280g è¼•ééƒ¨æ‰‹æ©Ÿ",
            "åŠŸç‡": "800W",
            "ä¿ä¿®": "2å¹´"
        },
        painPoints: [
            { pain: "å‡ºé–€è¶•æ™‚é–“ï¼Œè¡«çšºåˆ°ä¸èƒ½å‡ºé–€", solution: "30ç§’å³ç†± + ä¸€å™´å³å¹³ï¼Œå†‡æ™‚é–“æ´—è¡«éƒ½å¾—" },
            { pain: "å‚³çµ±æ›ç‡™æ©Ÿå¥½é‡å¥½å¤§ï¼Œé˜»ä½", solution: "282g ç´°ç´°éš»ï¼Œæ”¾å±‹ä¼é‚Šéš»è§’éƒ½å¾—" },
            { pain: "é«˜æº«æœƒå‚·è¡£æ–™ï¼Œç‡™åˆ°è®Šæ®˜", solution: "æ†æº«è¨­è¨ˆï¼Œæ£‰ã€éº»ã€çœŸçµ²éƒ½é©ç”¨" },
            { pain: "ç¶“å¸¸è¦ä¹¾æ´—åº—ï¼Œä¸€æ¬¡æˆèšŠå¹¾ç™¾èšŠ", solution: "è²·ä¸€æ¬¡ç”¨è¶³3å¹´ï¼Œå¹´åº•å·²å›æœ¬" }
        ]
    },
    {
        id: 1,
        emoji: "ğŸ’¨",
        name: "æ‘ºç–Šè² é›¢å­é«˜é€Ÿé¢¨ç­’",
        brand: "inno3C",
        model: "i-FD8",
        brandDesc: "inno3C - å‰µæ–°3Cç§‘æŠ€å“ç‰Œï¼Œå°ˆæ³¨æ–¼æ™ºèƒ½ç”Ÿæ´»é›»å™¨",
        srp: "$698",
        specs: {
            "åŠŸç‡": "1800W é«˜æ•ˆé¦¬é”",
            "é¢¨é€Ÿ": "æœ€é«˜ 65m/s å¼·æª”",
            "ä¹¾é«®æ™‚é–“": "æ¿•é«®â†’åŠä¹¾ åªéœ€3åˆ†é˜",
            "è² é›¢å­æ¿ƒåº¦": "3ç™¾è¬ è² é›¢å­/cmÂ³ï¼ˆè­·é«®ç´šåˆ¥ï¼‰",
            "æº«åº¦æª”": "3æª”æº«åº¦ + å†·é¢¨å®šå‹",
            "é‡é‡": "420g è¼•å¦‚ç¾½æ¯›",
            "æ‘ºç–Šå°ºå¯¸": "A5 ç´™å¤§å°ï¼ˆ12x8x6cmï¼‰"
        },
        painPoints: [
            { pain: "å†¬å¤©æ¿•é«®æœƒæ„Ÿå†’ï¼Œå¤å¤©å¹åˆ°ä¸€èº«æ±—", solution: "3åˆ†é˜å¿«é€Ÿä¹¾èº«ï¼Œå†¬æš–å¤çˆ½" },
            { pain: "å‚³çµ±é¢¨ç­’å¹å””ä¹¾ï¼Œé ­é«®æ¯›èºæ‰“çµ", solution: "1800W å¼·å‹ + è² é›¢å­é–æ°´ï¼Œå¹å®Œæ¯”æ²™é¾ä»²éš" },
            { pain: "é¢¨ç­’å¥½é‡å¥½ç†±ï¼Œèˆ‰åˆ°æ‰‹é…¸", solution: "420g è¼•å¦‚ç¾½æ¯›ï¼Œå†·é¢¨å¾ªç’°å””æœƒç‡’æ‰‹" },
            { pain: "å‡ºå·®/å»å®¿èˆï¼Œè¡Œæå·²ç¶“æ»¿", solution: "æ‘ºç–Šå¾ŒA5å¤§å°ï¼Œæ”¾èƒŒåŒ…éƒ½å†‡å•é¡Œ" }
        ]
    },
    {
        id: 2,
        emoji: "ğŸ ",
        name: "æ™ºèƒ½ç„¡ç·šHEPAæ—‹é¢¨å¸å¡µæ©Ÿ",
        brand: "Smartech",
        model: "SV-8178",
        brandDesc: "Smartech - é¦™æ¸¯æœ¬åœ°æ™ºèƒ½å®¶é›»å“ç‰Œ",
        srp: "$1,498",
        specs: {
            "å¸åŠ›": "28kPa æ¥­ç•Œé ˜å…ˆ",
            "çºŒèˆªæ™‚é–“": "ä¸€æ¬¡å……é›» 35-40åˆ†é˜ï¼ˆè¶³å¤ ä¸€å±¤æ¨“ï¼‰",
            "é›»æ± ": "3000mAh é‹°é›»æ± ï¼ˆå……3.5å°æ™‚ï¼‰",
            "é‡é‡": "1.8kgï¼ˆå°æ¯”å‚³çµ±3-5kg è¼•åŠå€ï¼‰",
            "æ¿¾ç¶²": "HEPA 13ç´šï¼ˆéæ¿¾99.99%ç´°èŒç—…æ¯’ï¼‰",
            "é›†å¡µå®¹é‡": "0.7L",
            "è»Šå°¾ç®±æ¨¡å¼": "âœ… æ´—å®Œè»Šç›´æ¥å¸ä¹¾æ·¨"
        },
        painPoints: [
            { pain: "æœ‰å¯µç‰©ï¼Œæ¯›é«®åˆ°è™•éƒ½ä¿‚", solution: "å°ˆé–€è¨­è¨ˆå¯µç‰©æ¯›å¸åŠ›ï¼Œä¸€å¸å³æ·¨" },
            { pain: "å‚³çµ±å¸å¡µæ©Ÿè¦ç‰½å°¾ç·šï¼Œåˆ°è™•å¡ä½", solution: "ç„¡ç·šè¨­è¨ˆï¼Œæ¨“æ¢¯ã€å»æ‰€ã€è»Šå°¾ç®±å…¨èƒ½å¸" },
            { pain: "å¸å®Œå¡µæ˜“éæ•ï¼Œå®¶è£¡ç©ºæ°£æ±¡æ¿", solution: "HEPAæ¿¾ç¶²æ·¨åŒ–ç©ºæ°£ï¼Œç´°èŒç—…æ¯’out" },
            { pain: "å¥³æ€§ç”¨å‚³çµ±å¸å¡µæ©Ÿæ‰‹è‡‚é…¸ç—›", solution: "1.8kg è¼•å·§ï¼Œæ¡æ„Ÿèˆ’é©ï¼Œ30åˆ†é˜ç„¡å•é¡Œ" }
        ]
    },
    {
        id: 3,
        emoji: "ğŸ’§",
        name: "å³ç†±UV-Cè¶…æ¿¾é£²æ°´æ©Ÿ",
        brand: "inno3C",
        model: "i-WD25",
        brandDesc: "inno3C - å‰µæ–°3Cç§‘æŠ€å“ç‰Œï¼Œé¦™æ¸¯åŸå» ç ”è£½",
        srp: "$2,998",
        specs: {
            "éæ¿¾ç³»çµ±": "4é‡éæ¿¾ + UV-Cç´«å¤–å…‰æ®ºèŒ",
            "ç¬¬1å±¤": "æ—¥æœ¬æ±éº—(TORAY)è¶…æ¿¾ Ultra-Filtration",
            "ç¬¬2å±¤": "æ´»æ€§ç¢³çº–ç¶­ï¼ˆå»é‡é‡‘å±¬ã€æ°¯æ°£ã€ç•°å‘³ï¼‰",
            "ç¬¬3å±¤": "Ag+éŠ€é›¢å­ï¼ˆé•·æ•ˆæŠ‘åˆ¶ç´°èŒç¹æ®–ï¼‰",
            "ç¬¬4å±¤": "éš±è—UV-Cç´«å¤–ç·šï¼ˆæ®ºèŒç‡99.99%ï¼‰",
            "å³ç†±æº«åº¦": "13ç¨®èª¿ç¯€ (45Â°Cè‡³96-100Â°C)",
            "åŠ ç†±é€Ÿåº¦": "åªéœ€3ç§’å³å‡ºç†±æ°´",
            "å‡ºæ°´å®¹é‡": "20ç¨®é¸æ“‡ï¼ˆ100mlè‡³1200mlï¼‰",
            "æ°´ç®±å®¹é‡": "3Læ‰‹æå¼ï¼ˆå…¨æ¸¯æœ€ç´°ã€æœ€é©é¦™æ¸¯å®¶å±…ï¼‰",
            "å°ºå¯¸": "370Ã—135Ã—293mm",
            "åŠŸç‡": "2000W",
            "æ¿¾èŠ¯å£½å‘½": "1500Lï¼ˆç´„1å¹´ï¼‰",
            "è€—é›»": "25åº¦/æœˆï¼ˆå¹´é›»è²»$60ï¼Œæœˆçœ$40ï¼‰"
        },
        painPoints: [
            { pain: "æ¯æ—¥ç‡’æ°´ç­‰åˆ°å¤©è’åœ°è€ï¼Œè¶•ä¸Šç­å†‡æ™‚é–“", solution: "3ç§’å³ç†±ï¼ˆæ¥­ç•Œæœ€å¿«ï¼‰ï¼Œæ—©ä¸Šèµ·èº«å€’æ¯å°±é£²" },
            { pain: "è²·æ¨½è£æ°´æ¯æœˆæˆå¹¾ç™¾èšŠï¼Œåˆç’°ä¿æ±¡æŸ“", solution: "å¹´é›»è²»$60ï¼Œæœˆçœ$40ï¼Œé ä½æ–¼æ¨½è£æ°´æˆæœ¬" },
            { pain: "è‡ªä¾†æ°´æœ‰æ°¯æ°£å‘³ï¼Œé£²å””æ…£", solution: "æ´»æ€§ç¢³çº–ç¶­å»æ°¯ï¼Œé£²èµ·ä¾†åŒè’¸é¤¾æ°´å’ç´”æ·¨" },
            { pain: "è€äººå°æœ‹å‹æ€•é£²å””å®‰å…¨å˜…æ°´", solution: "UV-C + 3å±¤æ®ºèŒï¼Œ99.99%æ»…ç—…èŒï¼Œæ¯”é†«é™¢æ‰‹è¡“å®¤æ›´æ·¨" }
        ]
    },
    {
        id: 4,
        emoji: "â­",
        name: "å³ç†±é£²æ°´æ©Ÿ + è¶…æ¿¾æ¿¾èŠ¯å¥—è£",
        brand: "inno3C",
        model: "i-WD25 Bundle",
        brandDesc: "inno3C - å‰µæ–°3Cç§‘æŠ€å“ç‰Œ",
        srp: "$3,596",
        specs: {
            "åŒ…å«": "ä¸»æ©Ÿ (å…§ç½®1å€‹æ¿¾èŠ¯) + é¡å¤–æ¿¾èŠ¯ 1å€‹",
            "4é‡éæ¿¾": "åŒ i-WD25 ä¸€æ¨¡ä¸€æ¨£",
            "æ¿¾èŠ¯å£½å‘½": "æ¯å€‹1500L (3-6å€‹æœˆ)ï¼Œå…§ç½®+é¡å¤–å…±å¯ç”¨6å€‹æœˆ",
            "ç›¸ç•¶æ–¼": "è²·æ©Ÿé€æ¿¾èŠ¯ï¼Œç„¡é¡å¤–æˆæœ¬",
            "å„ªå‹¢": "åˆ°æ‰‹å³ç”¨ï¼Œæ¯‹é ˆç«‹å³å†è²·æ¿¾èŠ¯",
            "ä¿ä¿®": "2å¹´ä¸»æ©Ÿ + çµ‚èº«å®¢æœæ”¯æ´",
            "æœ€é©åˆ": "é€ç¦®ã€ä¼æ¥­åœ˜è³¼ã€é‡è¦–ä¾¿åˆ©æ€§"
        },
        painPoints: [
            { pain: "è²·å’—æ©Ÿåˆè¦æ“”å¿ƒå¾ŒçºŒæ¿¾èŠ¯è²»ç”¨", solution: "é¡å¤–è´ˆé€1å€‹æ¿¾èŠ¯ï¼Œ6å€‹æœˆå…§å®Œå…¨ç„¡ç…©æƒ±" },
            { pain: "é€ç¦®æ€•æ”¶ç¦®äººæ—¥å¾Œè‡ªå·±ææ¿¾èŠ¯", solution: "é€åˆ°æ‰‹å·²ç¶“åŒ…å«2å€‹æ¿¾èŠ¯ï¼Œæ”¶ç¦®äººç„¡è² æ“”" },
            { pain: "ä¼æ¥­åœ˜è³¼ï¼Œæ€•å“¡å·¥æ¿¾èŠ¯ç®¡ç†äº‚", solution: "å¥—è£æ¨¡å¼æ¸…æ™°ï¼Œå“¡å·¥å®¹æ˜“ç®¡ç†" },
            { pain: "å””çŸ¥å¹¾æ™‚è¦æ›æ¿¾èŠ¯", solution: "å…§ç½® + é¡å¤–å…±2å€‹ï¼Œ6å€‹æœˆå‰å®Œå…¨ç„¡é ˆæ“”å¿ƒ" }
        ]
    },
    {
        id: 5,
        emoji: "ğŸ”Š",
        name: "Jelly Fish è—ç‰™å–‡å­",
        brand: "Jelly Fish",
        model: "Bluetooth Speaker",
        brandDesc: "Jelly Fish - æ–°èˆˆéŸ³æ¨‚ç§‘æŠ€å“ç‰Œ",
        srp: "$368",
        specs: {
            "åŠŸç‡": "10W é«˜ä¿çœŸéŸ³æ•ˆ",
            "é »ç‡éŸ¿æ‡‰": "20Hz - 20kHzï¼ˆå…¨é »æ®µï¼‰",
            "çºŒèˆªæ™‚é–“": "30å°æ™‚é€£çºŒæ’­æ”¾ï¼ˆå¾…æ©Ÿ500å°æ™‚ï¼‰",
            "å……é›»æ™‚é–“": "2å°æ™‚",
            "é˜²æ°´ç­‰ç´š": "IPX7ï¼ˆæµ¸æ°´1ç±³ã€30åˆ†é˜å†‡äº‹ï¼‰",
            "é‡é‡": "280g",
            "å°ºå¯¸": "ç›´å¾‘8cm x é«˜10cmï¼ˆæ˜“ carryï¼‰"
        },
        painPoints: [
            { pain: "å»æµ·é‚Šçƒ¤è‚‰ï¼Œæ‰‹æ©Ÿæ”¾æµªåº¦å†‡è²", solution: "IPX7 é˜²æ°´ï¼Œæ¿ºæ°´å†‡äº‹ï¼Œç¨ç«‹å–‡å­å¤ è²" },
            { pain: "å¥èº«æˆ¿ç§Ÿç”¨å–‡å­è¦ç•€éŒ¢", solution: "å¸¶ä¸Šå‘¢å€‹å–‡å­ï¼Œç§äººå¥èº«èª²å†‡å•é¡Œ" },
            { pain: "å®¿èˆèˆå‹å””ç¬ï¼Œä¸€å€‹äººç„¡æ°£æ°›", solution: "360åº¦ç’°ç¹éŸ³ï¼Œé–“æˆ¿è®Š party room" },
            { pain: "æ´¾å°è¦æ¥å®¢äººæ­Œï¼Œæ’ç·šè¶…éº»ç…©", solution: "30å°æ™‚çºŒèˆªï¼Œç„¡ç·š free play" }
        ]
    },
    {
        id: 6,
        emoji: "ğŸ”‹",
        name: "M0 OLED QI2 è¶…è–„ç£å¸ç„¡ç·šå……é›»å¯¶",
        brand: "inno3C",
        model: "i-3C5M2",
        brandDesc: "inno3C - å‰µæ–°3Cç§‘æŠ€å“ç‰Œ",
        srp: "$368",
        specs: {
            "å®¹é‡": "5000mAhï¼ˆä¸€èˆ¬æ‰‹æ©Ÿ1.2å€ï¼‰",
            "å°ºå¯¸": "åšåº¦åªæœ‰ 4mmï¼ˆä¿¡ç”¨å¡åšåº¦ï¼ï¼‰",
            "é‡é‡": "125gï¼ˆåŠéƒ¨ iPhone é‡ï¼‰",
            "ç„¡ç·šè¼¸å‡º": "15W Qi2 æ¨™æº–ï¼ˆç£å¸è‡ªå‹•å°é½Šï¼‰",
            "æœ‰ç·šè¼¸å‡º": "USB-C 15W + USB-A 5W é›™è¼¸å‡º",
            "å¿«å……æ™‚é–“": "15åˆ†é˜å¿«å……50%ï¼ˆæ•‘æ€¥ç”¨ï¼‰",
            "ç£å¸åŠ›": "å¼·åŠ›N52ç£çŸ³ï¼ˆå””æœƒæ‰ï¼‰"
        },
        painPoints: [
            { pain: "å‡ºé–€æ‰‹æ©Ÿç„¡é›»ï¼Œæ‰¾å……é›»ç·šè¶…éº»ç…©", solution: "ç£å¸å³å•²å³æœ‰é›»ï¼Œå†‡ç·šä¹œå˜¢ç…©æƒ±" },
            { pain: "å……é›»ç·šæˆæ—¥æ–·æ‰ï¼Œé‡è¤‡è²·æµªè²»", solution: "ç„¡ç·šç£å¸æ°¸é ç”¨åˆ°çˆ›" },
            { pain: "æ”å‡ºèƒŒåŒ…è¦æ•´ç†ç·šçºçº", solution: "4mm å¡åšåº¦ï¼Œå¹³æ”¾èƒŒåŒ…è§’è½" },
            { pain: "é–‹æœƒ/è¦‹å®¢è¦ç©æ‰‹æ©Ÿï¼Œç·šæœƒæ‰", solution: "ç£å¸ç‰¢ç‰¢è²¼å¯¦ï¼Œå®Œå…¨å””æ´—æ“”å¿ƒ" }
        ]
    }
];

let currentUser = null;
let currentGadget = null;
let selectedGadgets = [];
let reports = JSON.parse(localStorage.getItem('sales_reports')) || [];

document.getElementById('user-role').addEventListener('change', function() {
    document.getElementById('admin-pass-section').style.display = this.value === 'admin' ? 'block' : 'none';
});

function initializeGadgets() {
    const grid = document.getElementById('gadgets-grid');
    grid.innerHTML = '';
    GADGETS.forEach(gadget => {
        const card = document.createElement('button');
        card.type = 'button';
        card.className = 'gadget-card';
        card.id = `gadget-card-${gadget.id}`;
        card.innerHTML = `<div class="gadget-emoji">${gadget.emoji}</div><div class="gadget-text"><strong>${gadget.brand}</strong><br>${gadget.model}</div><div class="gadget-qty" id="qty-${gadget.id}"></div>`;
        card.onclick = (e) => { e.preventDefault(); selectGadgetForDetail(gadget); };
        grid.appendChild(card);
    });
}

function selectGadgetForDetail(gadget) {
    currentGadget = gadget;
    
    document.getElementById('detail-emoji').textContent = gadget.emoji;
    document.getElementById('detail-name').textContent = gadget.name;
    document.getElementById('detail-brand').textContent = gadget.brand;
    document.getElementById('detail-brand-desc').textContent = gadget.brandDesc;
    document.getElementById('detail-model').textContent = gadget.model;
    document.getElementById('detail-srp').textContent = gadget.srp;
    
    let specHtml = '';
    for (let [key, value] of Object.entries(gadget.specs)) {
        specHtml += `<div class="spec-item"><div class="spec-label">${key}</div><div class="spec-value">${value}</div></div>`;
    }
    document.getElementById('spec-grid').innerHTML = specHtml;
    
    let painHtml = '';
    gadget.painPoints.forEach(item => {
        painHtml += `
            <div class="pain-point-row">
                <div class="pain-point-left">
                    <div class="pain-title">âŒ å•é¡Œ</div>
                    <div class="pain-text">${item.pain}</div>
                </div>
                <div class="pain-point-right">
                    <div class="solution-title">âœ… è§£æ±º</div>
                    <div class="solution-text">${item.solution}</div>
                </div>
            </div>
        `;
    });
    document.getElementById('pain-points-content').innerHTML = painHtml;
    
    document.getElementById('gadget-detail').classList.add('active');
    document.getElementById('current-qty').value = '0';
    document.getElementById('qty-label').textContent = `${gadget.name} - è¼¸å…¥éŠ·å”®æ•¸é‡`;
}

function addGadgetToList() {
    if (!currentGadget) { alert('âŒ è«‹å…ˆé¸æ“‡ç¦®å“'); return; }
    
    const qty = parseInt(document.getElementById('current-qty').value) || 0;
    if (qty <= 0) { alert('âŒ è«‹è¼¸å…¥æ­£ç¢ºæ•¸é‡'); return; }
    
    const existing = selectedGadgets.find(g => g.id === currentGadget.id);
    if (existing) {
        existing.qty = qty;
    } else {
        selectedGadgets.push({
            id: currentGadget.id,
            name: currentGadget.name,
            brand: currentGadget.brand,
            model: currentGadget.model,
            emoji: currentGadget.emoji,
            qty: qty
        });
    }
    
    updateGadgetsList();
    document.getElementById('current-qty').value = '0';
}

function updateGadgetsList() {
    const listHtml = selectedGadgets.map((g, idx) => `
        <div class="gadget-item">
            <div class="gadget-item-info">
                <div class="gadget-item-name">${g.emoji} ${g.brand} ${g.model}</div>
                <div class="gadget-item-qty">æ•¸é‡: ${g.qty} ä»¶</div>
            </div>
            <button type="button" class="remove-btn" onclick="removeGadgetFromList(${g.id})">ğŸ—‘ï¸ ç§»é™¤</button>
        </div>
    `).join('');
    
    const listDiv = document.getElementById('gadgets-list');
    listDiv.innerHTML = listHtml;
    
    GADGETS.forEach(g => {
        const selected = selectedGadgets.find(sg => sg.id === g.id);
        const qtyLabel = document.getElementById(`qty-${g.id}`);
        if (selected) {
            qtyLabel.textContent = `âœ… x${selected.qty}`;
        } else {
            qtyLabel.textContent = '';
        }
    });
    
    document.getElementById('selected-list').style.display = selectedGadgets.length > 0 ? 'block' : 'none';
}

function removeGadgetFromList(id) {
    selectedGadgets = selectedGadgets.filter(g => g.id !== id);
    updateGadgetsList();
}

function handleLogin() {
    const name = document.getElementById('user-name').value.trim();
    const role = document.getElementById('user-role').value;
    const pass = document.getElementById('admin-pass').value;
    
    if (!name) { alert('âŒ è«‹è¼¸å…¥åå­—'); return; }
    if (!role) { alert('âŒ è«‹é¸æ“‡èº«ä»½'); return; }
    if (role === 'admin' && pass !== ADMIN_PASSWORD) { alert('âŒ å¯†ç¢¼éŒ¯èª¤'); return; }
    
    currentUser = { name, role };
    document.getElementById('login-screen').style.display = 'none';
    
    if (role === 'staff') {
        document.getElementById('staff-screen').style.display = 'block';
        document.getElementById('staff-name').textContent = `åŒäº‹: ${name}`;
        document.getElementById('staff-date').textContent = `æ—¥æœŸ: ${new Date().toLocaleDateString('zh-HK')}`;
        initializeGadgets();
    } else {
        document.getElementById('admin-screen').style.display = 'block';
        refreshAdminView();
    }
}

function logout() {
    currentUser = null;
    currentGadget = null;
    selectedGadgets = [];
    document.getElementById('login-screen').style.display = 'flex';
    document.getElementById('staff-screen').style.display = 'none';
    document.getElementById('admin-screen').style.display = 'none';
    document.getElementById('user-name').value = '';
    document.getElementById('user-role').value = '';
    document.getElementById('admin-pass').value = '';
}

function submitStaffReport(e) {
    e.preventDefault();
    
    const leader = document.getElementById('leader').value;
    if (!leader) { alert('âŒ è«‹é¸æ“‡ Leader'); return; }
    
    const cis = parseInt(document.getElementById('cis').value) || 0;
    const vas = parseInt(document.getElementById('vas').value) || 0;
    const adhoc1 = parseInt(document.getElementById('adhoc1').value) || 0;
    const adhoc2 = parseInt(document.getElementById('adhoc2').value) || 0;
    const adhoc3 = parseInt(document.getElementById('adhoc3').value) || 0;
    const notes = document.getElementById('notes').value;
    
    const gadgetsList = selectedGadgets.length > 0 
        ? selectedGadgets.map(g => `${g.brand} ${g.model} (x${g.qty})`).join(' | ')
        : 'ç„¡';
    
    const now = new Date();
    const report = {
        date: now.toISOString().split('T')[0],
        time: now.toTimeString().split(' ')[0],
        staff: currentUser.name,
        leader,
        cis, vas, adhoc1, adhoc2, adhoc3,
        gadgets: gadgetsList,
        notes
    };
    
    reports.push(report);
    localStorage.setItem('sales_reports', JSON.stringify(reports));
    
    // è‡ªå‹•åŒæ­¥åˆ° Google Sheets
    syncReportToGoogle(report);
    
    document.getElementById('success-msg').classList.add('show');
    setTimeout(() => document.getElementById('success-msg').classList.remove('show'), 3000);
    
    e.target.reset();
    document.getElementById('gadget-detail').classList.remove('active');
    document.getElementById('selected-list').style.display = 'none';
    selectedGadgets = [];
    initializeGadgets();
    currentGadget = null;
}

// å–®ç­†åŒæ­¥åˆ° Google Sheets
function syncReportToGoogle(report) {
    const values = [[
        report.date,
        report.time,
        report.staff,
        report.leader,
        report.cis,
        report.vas,
        report.adhoc1,
        report.adhoc2,
        report.adhoc3,
        report.gadgets,
        report.notes
    ]];
    
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEET_ID}/values/'Sheet1'!A:K:append?valueInputOption=USER_ENTERED&key=${GOOGLE_API_KEY}`;
    
    axios.post(url, { values })
        .then(() => {
            console.log('âœ… å·²åŒæ­¥åˆ° Google Sheets');
        })
        .catch(err => {
            console.log('âš ï¸ Google Sheets åŒæ­¥å¤±æ•—:', err.response?.data || err.message);
        });
}

// å…¨éƒ¨åŒæ­¥åˆ° Google Sheets
function syncToGoogleSheets() {
    if (!GOOGLE_SHEET_ID || !GOOGLE_API_KEY) {
        alert('âŒ Google Sheets è¨­å®šæœªå®Œæˆ');
        return;
    }
    
    if (reports.length === 0) { 
        alert('âŒ æ²’æœ‰æ•¸æ“š'); 
        return; 
    }
    
    document.getElementById('sync-status').textContent = 'â³ æ­£åœ¨åŒæ­¥...';
    
    const values = reports.map(r => [
        r.date,
        r.time || '',
        r.staff,
        r.leader || '',
        r.cis,
        r.vas,
        r.adhoc1,
        r.adhoc2,
        r.adhoc3,
        r.gadgets,
        r.notes
    ]);
    
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEET_ID}/values/'Sheet1'!A:K:append?valueInputOption=USER_ENTERED&key=${GOOGLE_API_KEY}`;
    
    axios.post(url, { values })
        .then((response) => {
            document.getElementById('sync-status').textContent = 'âœ… å·²åŒæ­¥åˆ° Google Sheets';
            setTimeout(() => document.getElementById('sync-status').textContent = '', 3000);
            alert('âœ… å·²åŒæ­¥ ' + reports.length + ' ç­†æ•¸æ“šåˆ° Google Sheets\n\nğŸ’¾ æ•¸æ“šåŒæ™‚å·²ä¿å­˜åœ¨æœ¬åœ° LocalStorage');
        })
        .catch(err => {
            document.getElementById('sync-status').textContent = 'âŒ åŒæ­¥å¤±æ•—';
            setTimeout(() => document.getElementById('sync-status').textContent = '', 3000);
            console.error('Google Sheets åŒæ­¥éŒ¯èª¤:', err.response?.data || err.message);
            alert('âŒ åŒæ­¥å¤±æ•—: ' + (err.response?.data?.error?.message || err.message));
        });
}

function refreshAdminView() {
    const today = new Date().toISOString().split('T')[0];
    const todayData = reports.filter(r => r.date === today);
    
    let cis = 0, vas = 0, adhoc = 0;
    todayData.forEach(r => { cis += r.cis; vas += r.vas; adhoc += r.adhoc1 + r.adhoc2 + r.adhoc3; });
    
    document.getElementById('stats-grid').innerHTML = `
        <div class="stat-box"><div>ğŸ“± ä»Šæ—¥ CIS</div><div class="stat-value">${cis}</div></div>
        <div class="stat-box"><div>â• ä»Šæ—¥ VAS</div><div class="stat-value" style="color: #10b981;">${vas}</div></div>
        <div class="stat-box"><div>ğŸ Ad-Hoc VAS</div><div class="stat-value" style="color: #ef4444;">${adhoc}</div></div>
        <div class="stat-box"><div>ğŸ“Š å ±æ•¸æ¬¡æ•¸</div><div class="stat-value" style="color: #8b5cf6;">${todayData.length}</div></div>
    `;
    
    const tbody = document.getElementById('table-body');
    tbody.innerHTML = '';
    
    if (reports.length === 0) {
        document.getElementById('no-data-msg').style.display = 'block';
        return;
    }
    
    document.getElementById('no-data-msg').style.display = 'none';
    reports.slice().reverse().forEach(r => {
        tbody.innerHTML += `<tr><td>${r.date}</td><td>${r.staff}</td><td>${r.leader || '-'}</td><td>${r.cis}</td><td>${r.vas}</td><td>${r.adhoc1}</td><td>${r.adhoc2}</td><td>${r.adhoc3}</td><td>${r.gadgets}</td><td>${r.notes}</td></tr>`;
    });
}

function exportToCSV() {
    if (reports.length === 0) { alert('âŒ æ²’æœ‰æ•¸æ“š'); return; }
    
    let csv = 'æ—¥æœŸ,æ™‚é–“,åŒäº‹,Leader,CIS,VAS,2500M,Router,PCD NEW,ç¦®å“éŠ·å”®,å‚™è¨»\n';
    reports.forEach(r => {
        csv += `${r.date},${r.time || ''},${r.staff},${r.leader || ''},${r.cis},${r.vas},${r.adhoc1},${r.adhoc2},${r.adhoc3},"${r.gadgets}","${r.notes}"\n`;
    });
    
    const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv; charset=utf-8;' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = `Sales_Report_${new Date().toISOString().split('T')[0]}.csv`;
    link.click();
}

initializeGadgets();
</script>

</body>
</html>